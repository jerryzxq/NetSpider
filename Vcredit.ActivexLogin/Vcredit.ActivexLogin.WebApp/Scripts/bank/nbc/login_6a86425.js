;/*!/src/app/login/loginController.js*/
angular.module("login", ["ngRoute"]).config(["$routeProvider", function (e) { e.when("/login/:paramsid?", { template: '<div ng-controller="loginController" class="login"><form name="mainForm" ><ul><li><label class="loginLabel">账号：</label><input type="text" tabindex="1" name="userName" class="input-text login-input-text" ng-model="userName" placeholder="账号/ 登录名/ 身份证/ 手机号"    validator="required" ng-blur="getCheckCodeFlag();" autocapitalize="off" autocomplete="off"/><p class="p-all"><em ng-show="mainForm.$showErrorMsg && mainForm.userName.$error.required">请输入用户名</em></p></li><li><label>密码：</label><div passwordctrl check-ereg="regPwd" max-length="maxLength" class="passwordctrl" pass-operator="passOperator" enter-callback="enterClick();"/><p class="p-all"><em ng-show="mainForm.$showErrorMsg && !passOperator.checkValid()">请正确输入密码</em></p></li><li ng-if="isCheckCode"><label  class="loginLabel">验证码：</label><input class="verifyInput input-text login-input-text" tabindex="3" type="text" name="verifyImage" maxlength="4" ng-model="$parent.verifyImageCode"    ng-keydown="enterClick($event);" placeholder="不区分大小写" validator="required|verifyImage"/><img class="verifyImageCode pointer" title="看不清？点击更换" ng-src="{{verifyImageUrl}}" ng-click="updateVerifyImage();"/><p class="p-all"><em ng-show="mainForm.$showErrorMsg && mainForm.verifyImage.$error.required">请输入图形验证码</em><em ng-show="mainForm.$showErrorMsg && mainForm.verifyImage.$error.verifyImage">请正确输入图形验证码</em></p></li><li><a ng-click="login()" class="btn1 aButton" id="loginBtn1">登&nbsp;&nbsp;录</a><p class="p-all"><em ng-show="isError" ng-bind="errMsg"></em></p><div class="controls" ><span style="padding-left: 50px;">证书客户第一次登录请下载</span><span><div style="float:right" ><a href="assets/nbcbEdit/NingBoBankBuddy.exe" title="" style="padding-right: 40px;">网银向导</a></div></span></div></li></ul><p class="p-all online-account"><a ng-click="jumpRepass()" class="back">设置密码</a>&nbsp;|&nbsp;<a href="#/HB00900">在线开户</a></p></form></div>', controller: "loginController" }) }]).controller("loginController", ["$scope", "$log", "$httpPlus", "$routeHelper", "$utb", "$loginFlow", "$message", "$location", function (e, r, a, o, s, n, i) { function l() { b = m(), e.passOperator = null, e.enterClick = g, e.login = p, e.verifyImageUrl = s.getUrl("VerifyImage") + "&flag=" + (new Date).getTime(), e.updateVerifyImage = c, e.isCheckCode = !1, e.getCheckCodeFlag = u, e.regPwd = "^[A-Za-z0-9!#$%&()*+,-./:;<=>?@[\\]^_{|}~]{6,12}$", e.maxLength = "12" } function t() { var e = i.getParams() || {}; return "loginFlag" in e ? e.loginFlag : "2" } function c() { e.verifyImageUrl = s.getUrl("VerifyImage") + "&flag=" + (new Date).getTime() } function g(e) { if (e) { var r = e.keyCode || e.which; if ("13" != r) return } p() } function p() { e.isError = !1, e.errMsg = "", e.mainForm.checkValid() && e.passOperator.checkValid() && (C || (C = !0, $("#loginBtn1").text("登录中...").attr("disabled", "disabled"), s.getSrandNum(d))) } function d() { var r, o = {}; o.accountNo = e.userName, o.password = e.passOperator.getValue(), e.isCheckCode && (o.checkCode = e.verifyImageCode), r = e.passOperator.getControlParams(), angular.extend(o, r), o.isShowLogin = "", o.logonVersion = "1", a.post("/bank/HBsignIn?Token=" + strToken, o).success(function (r) { var o = r.em; if (C = !1, "0000" == r.ec) { var s = r.cd.session_voucher, i = r.cd.certID; if ("6" == r.cd.retValue) { if (!("329" != s && "343" != s && "360" != s && "328" != s || i && "nbcb" == i.substring(0, 4))) { var l = r.cd.session_customerId; return void a.post("HBclearSecurity.do", { accNo: l }).success(function () { n.switchToMybank("", {}, !0, r.cd.sessionId) }) } f(r.cd.sessionId, r.cd) } else h(r.cd) } else "1211" == r.ec ? e.passOperator.clear() : "1964" == r.ec ? (e.passOperator.clear(), o = "密码已锁，您可通过网银、手机银行或拨打95574重新设置密码。") : "8888" == r.ec ? (e.userName = "", e.passOperator.clear(), e.verifyImageCode = "", o = "您的登录名或密码输入错误，请核对后重新输入。") : "C003" == r.ec || "EBPB5000" == r.ec || "EBPB0131" == r.ec ? (e.userName = "", e.passOperator.clear(), e.verifyImageCode = "", o = "您的登录名或密码输入错误，请核对后重新输入。") : "C004" == r.ec ? (e.userName = "", e.passOperator.clear(), e.verifyImageCode = "", o = "您未设置相应的登录密码， 请拨打宁波银行24小时客服热线设置。") : "EBPB0851" == r.ec && (e.verifyImageCode = "", o = "您输入的验证码不正确"), u(), e.isError = !0, e.errMsg = o, $("#loginBtn1").text("登录").removeAttr("disabled") }) } function m() { for (var e = {}, r = window.location.search.substring(1).split("&"), a = r.length, o = 0; a > o; o++) { var s = r[o].split("="); e[s[0]] = decodeURIComponent(s[1]) } return e } function u() { e.userName && a.post("/bank/HBcheckCodeFlag?token=" + strToken, { accountNo: e.userName }).success(function (r) { if ("0000" === r.ec) { var a = r.cd.flag, o = r.cd.logonFlag; a && "1" == a || o && "1" == o ? (c(), e.isCheckCode = !0) : e.isCheckCode = !1 } }) } function f(e, r) { n.login(e, function () { i.close() }, null, { pre: v, result: r, isPop: !0 }) } function h(e) { v(e) && n.login(e.sessionId, function () { i.close() }) } function v(r, a, o) { var s = r.sessionId, l = r.session_eAccFlag; return "01" == r.customerType && "1" != r.mobileVerify ? (e.passOperator.clear(), u(), e.isError = !0, e.errMsg = "您尚未开通短信认证，请登录我行网银进行签约。", !1) : "11" == r.customerType ? ("0" == y ? i.pop({ title: "登录跳转提示", src: "app/login/logincredit.tpl.html", entityClassName: "logincreditPop", onClose: function () { n.switchToMybank("", {}, !0, r.sessionId) } }) : (e.passOperator.clear(), u(), e.isError = !0, e.errMsg = "您是我行网银信用卡版客户，请至我行网点签约网银专业版。"), !1) : "3" != l && "0" == y ? (n.ebankDispatch(b, s), !1) : (a && a(o), !0) } var C = !1, y = t(), b = {}; l(), e.jumpRepass = function () { o.jump("/EXT00006", {}) } }]);
;/*!/src/app/login/logincreditController.js*/
angular.module("logincredit", ["ngRoute"]).controller("logincreditController", ["$scope", "$message", function (e, o) { e.makeSure = function () { o.close() } }]);
;/*!/src/app/login/loginModule.js*/
angular.module("loginModule", ["login", "logincredit"]);